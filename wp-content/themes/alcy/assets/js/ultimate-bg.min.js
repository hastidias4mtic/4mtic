
/**
 * ultimate bg.
 * Created by luis on 12/23/16.
 */
!function(m,b){function w(e){this.name="UltimateBackgroundException",this.message=e}function P(e,t){var o=e.outerWidth(),i=e.outerHeight();console.log("viewport height: "+m(b.top).height());var a,r,n=Math.floor(1*o/t.ratio),s=Math.floor(i*t.ratio);if("body"==t.container){var l;if("image"==t.type)return(l=Math.ceil(m(b).height()*t.ratio))<o?[o,n]:[l,m(b).height()];if("youtube"==t.type)return(l=Math.ceil(m(b).height()*t.ratio))<o?[o,n]:[l,m(b).height()]}return console.log("height: "+i+"------ calculated height"+n),console.log("width: "+o+"------ calculated width"+s),n<=i?(console.log("using original height and calculated width"),r=i,a=s):i<=n&&(console.log("using original width and calculated height"),a=o,r=n),[a,r]}b.c47YTIframeReady=!1,b.c47YTPlayers=[];var T="c47-ultimate-bg";m.fn.c47bg=function(n){var s=this;s.css("position","relative");n=m.extend(n,{ratio:16/9,mute:!0,repeat:!0,crop:!0}),console.log(n),console.log("tag name: ",this.prop("tagName")),"body"===this.prop("tagName").toLowerCase&&(console.log("removing padding and margin in body and html"),m("body,html").css("margin",0),m("body,html").css("padding",0));var e=P(s,n),i=e[0],a=e[1],t="c47-random-"+Math.floor(1e5*Math.random());if(n.crop&&n.container,"youtube"==n.type){var o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(o,r),s.find("."+T).remove();var l="body"==n.container?"fixed;":"absolute";y='<div style="position: absolute; top: 0; left: 0; overflow: hidden; z-index: -1;" class="'+T+'"><div style="-webkit-backface-visibility: hidden; backface-visibility: hidden;position:'+l+';" id="'+t+'" ></div></div>',s.prepend(y);var d=setInterval(function(){b.c47YTIframeReady&&(clearInterval(d),function(e,t,o,i){console.log("start a new player with video ID: "+t);var a=new YT.Player(e,{videoId:t,width:o,height:i,playerVars:{autoplay:1,controls:0,showinfo:0,loop:1,start:0,rel:0,modestbranding:1},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}});b.c47YTPlayers=b.c47YTPlayers||[],b.c47YTPlayers.push(a)}(t,n.source,i,a))},10);b.onYouTubeIframeAPIReady=function(){b.c47YTIframeReady=!0},b.onPlayerReady=function(e){e.target.playVideo(),e.target.mute()},b.onPlayerStateChange=function(e){if(0===e.data&&n.repeat){console.log("ok to repeat",b.c47YTPlayers.length);for(var t=0;t<b.c47YTPlayers.length;t++)console.log(b.c47YTPlayers[t].getPlayerState()),0==b.c47YTPlayers[t].getPlayerState()&&b.c47YTPlayers[t].seekTo(0)}}}else if("self-hosted"==n.type){if("object"!=typeof n.source)throw new w("The source property needs to be an object. Please go to https://github.com/datmt/ultimate-background for documentation");var c=n.source,h="",g="",p="",u="";if(void 0!==n.poster&&(h=n.poster),void 0!==c.mp4&&(g='<source src="'+c.mp4+'" type="video/mp4">'),void 0!==c.ogv&&(p='<source src="'+c.ogv+'" type="video/ogg">'),void 0!==c.webm&&(u='<source src="'+c.webm+'" type="video/webm">'),g==p==u=="")throw new w("Please provide at least one video source");var y='<div class="'+T+'" style="z-index: -1; position: absolute; top: 0; left: 0; overflow: hidden;"><video  autoplay="1" loop="1" muted="1" id="'+t+'" height="'+a+'" width="'+i+'" poster="'+h+'" >'+g+p+u+"Your browser doesn't support HTML5 video tag.</video></div>";s.prepend(y)}else if("image"==n.type){var v="body"==n.container?"fixed":"absolute",f='<div style="position: absolute; top: 0; left: 0; z-index: -1;" class="'+T+'"><img style="position: '+v+'; top: 0; left: 0;" id="'+t+'" src="'+n.source+'" /></div>';s.prepend(f)}return m(function(){var e=m("."+T),t=void 0===n.overlayClass?"b1":n.overlayClass,o="body"==n.container?"fixed":"absolute";0==e.find(".c47-overlay").length&&e.append('<div class="c47-overlay '+t+'" style="position: '+o+"; padding: 0; margin: 0; top: 0; bottom: 0; right: 0; left: 0; width: "+i+"px; height: "+a+'px; z-index: 100;"></div>');try{m(".c47-overlay").addEventListener("touchmove",function(e){e.preventDefault()},!1),e.addEventListener("touchmove",function(e){e.preventDefault()},!1)}catch(e){}m(b).bind("resize orientationchange",function(){console.log("resizing bg...;");var e,t=P(m(this),n),o=t[0],i=t[1],a=m(s).find("."+T).first();if(a.css("height",m(s).outerHeight()),a.css("width","100%"),"youtube"==n.type)(e=a.find("iframe").first()).attr("width",o),e.attr("height",i),e.css("top",0),e.css("left",0);else if("image"==n.type){(e=a.find("img").first()).css("width",o+"px"),e.css("height",i+"px");var r=o/2-m(b).width()/2;0<r&&1.4<m(b).height()/m(b).width()?e.css("margin-left","-"+r+"px"):e.css("margin-left","0")}else"self-hosted"==n.type&&((e=a.find("video")).attr("width",o),e.attr("height",i));e.siblings(".c47-overlay").css("width",o+"px"),e.siblings(".c47-overlay").css("height",i+"px")}),m(function(){console.log("triggering rezie manually"),m(s).trigger("resize")})}),this}}(jQuery,window);


